# ü§ñ ETL AI Assistant Backend - MVP

–ü—Ä–æ—Å—Ç–æ–π MVP –±—ç–∫–µ–Ω–¥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ ETL-–∑–∞–¥–∞—á —Å –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repo-url>
cd etl-ai-assistant

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker-compose ps
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
- Backend API: http://localhost:8080
- Airflow UI: http://localhost:8081 (admin/admin)
- PostgreSQL: localhost:5432
- ClickHouse: localhost:8123
- –ü—Ä–æ—Å—Ç–æ–π UI: http://localhost:8080/static/index.html

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ –±—ç–∫–µ–Ω–¥ (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω–æ)
uvicorn app.main:app --reload --port 8080
```

## üìã API –≠–Ω–¥–ø–æ–π–Ω—Ç—ã

### Health Checks
- `GET /api/v1/health/` - –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å
- `GET /api/v1/health/airflow` - –°—Ç–∞—Ç—É—Å Airflow
- `GET /api/v1/health/databases` - –°—Ç–∞—Ç—É—Å –ë–î

### –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- `POST /api/v1/analysis/file` - –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–æ–≤ (CSV/JSON/XML)
- `POST /api/v1/analysis/db` - –ê–Ω–∞–ª–∏–∑ —Ç–∞–±–ª–∏—Ü –ë–î

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- `POST /api/v1/recommend/storage` - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ö—Ä–∞–Ω–µ–Ω–∏—é

### DDL –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
- `POST /api/v1/ddl/generate` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è DDL —Å–∫—Ä–∏–ø—Ç–æ–≤

### ETL –ü–∞–π–ø–ª–∞–π–Ω—ã
- `POST /api/v1/pipelines/draft` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞
- `POST /api/v1/pipelines/publish` - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Airflow
- `POST /api/v1/pipelines/trigger/{dag_id}` - –ó–∞–ø—É—Å–∫ DAG
- `GET /api/v1/pipelines/status/{dag_id}` - –°—Ç–∞—Ç—É—Å DAG

## üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îî‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ api/v1/                # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ router.py
‚îÇ   ‚îú‚îÄ‚îÄ routes_health.py
‚îÇ   ‚îú‚îÄ‚îÄ routes_analysis.py
‚îÇ   ‚îú‚îÄ‚îÄ routes_recommend.py
‚îÇ   ‚îú‚îÄ‚îÄ routes_ddl.py
‚îÇ   ‚îî‚îÄ‚îÄ routes_pipelines.py
‚îú‚îÄ‚îÄ schemas/               # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ connectors/            # –ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã –∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
‚îî‚îÄ‚îÄ integrations/          # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Airflow)
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª (—Å–º. `.env.example`):
```bash
ENV=dev
CORS_ALLOW_ORIGINS=*
AIRFLOW_BASE_URL=http://localhost:8081
POSTGRES_DSN=postgresql+psycopg2://user:password@localhost:5432/etl_db
CLICKHOUSE_HOST=localhost
CLICKHOUSE_PORT=8123
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8080/static/index.html
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π UI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–π–Ω—Ç–æ–≤
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Swagger UI: http://localhost:8080/api/docs

## üì¶ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ

- ‚úÖ FastAPI —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- ‚úÖ –ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã: PostgreSQL, ClickHouse, —Ñ–∞–π–ª—ã (CSV/JSON/XML)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Airflow (–∑–∞–≥–ª—É—à–∫–∞)
- ‚úÖ Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ Docker Compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **ML-–∏–Ω–∂–µ–Ω–µ—Ä**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å LLM-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
2. **DevOps**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–¥–∞–∫—à–Ω –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (K8s, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
3. **Frontend**: –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π React UI
4. **–î–∞—Ç–∞-–∏–Ω–∂–µ–Ω–µ—Ä**: –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

- –ï—Å–ª–∏ Airflow –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è: `docker-compose logs airflow-webserver`
- –ï—Å–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã: `docker-compose logs postgres clickhouse`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `GET /api/v1/health/`


